<!doctype html>
<html lang="en" class="fixed">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>三门核电有限公司三门数字化仿真检修平台</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/css/bootstrap-3.3.4.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/animate.css/animate.css">
    <!--<link rel="stylesheet" href="stylesheets/css/style.css">-->
    <link rel="stylesheet" href="stylesheets/css/oeinsder.css">
</head>
<style>
    a:hover,
    a:focus {
        color: #23527c;
        text-decoration: none !important;
        cursor: pointer;
    }

    .peinsder-box {
        padding: 3px !important;
    }

    .onile-box .col-sm-3 {
        min-height: inherit !important;
    }

    .onile-box .col-sm-3, .onile-box .col-sm-9 {
        min-height: inherit !important;
    }

    .heard_top {
        line-height: 35px;
        background-color: rgb(31, 167, 193);
        font-size: 18px;
        font-weight: bolder;
        padding: 2px 10px;
        color: #fff;
        border-radius: 5px;
        margin: 0 -14px;
    }

    .heard_top i {
        margin-right: 10px;
    }

    .onile-box .col-sm-3 ul {
        margin: 0 -14px !important;

    }

    #prevs {
        display: none;
    }

    .subject-action {
        padding-top: 30px;
    }



    h3 {
        border-bottom: 1px solid #e7eaec;
        padding-bottom: 10px;
    }

    .subject-question p {
        font-size: 14px;
        font-weight: 700;
        line-height: 20px;
        margin-left: 0 !important;
    }

    .col-xs-7 {
        margin-left: 30px !important;
    }

    .btn {
        background: transparent;
        border: 1px solid #e7eaec;
        margin-bottom: 0px !important;
    }

    .onile-box .col-sm-3 ul li a {
        font-size: 20px !important;
        line-height: 54px !important;
    }

    .onile-box .col-sm-3 ul {
        /*border: 1px solid #ccc;*/
        background-color: transparent !important;
        color: rgb(51, 122, 183);
        padding-left: 20px;
    }

    #tip1 {
        margin: 30px 0 0 0;
        text-align: center;
        font-size: 16px;
        display: none;
    }

    #tip2 {
        margin: 30px 0 0 0;
        text-align: center;
        font-size: 16px;
        display: none;
    }

    .box {
        width: 160px;
        height: 160px;
        margin: 0 20px 20px 0;
        border-radius: 5%;
        float: left;
        position: relative;
        text-align: center;
        background-color: navajowhite;
    }

    .box img {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: 20px auto;
        max-width: 100%;
        max-height: 100%;
        outline: none;
    }

    #bgbox {
        display: none;
        position: absolute;
        top: 0%;
        left: 0%;
        width: 100%;
        height: 100%;
        background-color: black;
        z-index: 10001;
        opacity: .70;
        filter: alpha(opacity=70);
    }

    #boxshow {
        display: none;
        position: absolute;
        top: 25%;
        left: 22%;
        width: 53%;
        height: 49%;
        padding: 8px;
        border: 8px solid #E8E9F7;
        background-color: white;
        z-index: 10002;
        overflow: hidden;
    }

    #boxshow img {
        width: 100%;
        height: 100%;
    }

    #boxflash {
        display: none;
        position: absolute;
        top: 20%;
        left: 10%;
        width: 80%;
        height: 60%;
        padding: 8px;
        border: 8px solid #E8E9F7;
        background-color: white;
        z-index: 10002;
        overflow: hidden;
    }

    #close_btn, #close_btn2 {
        position: absolute;
        right: 0;
        top: 0;
    }

    #lable-count {
        padding: 0 10px;
        border-radius: 5px;
        opacity: 0.3;
        font-size: 20px;
        filter: alpha(opacity=30);
        background-color: coral;
    }

    #flash-content {
        z-index: -1;
        overflow: auto;
    }

    #flash2 {
        width: 100%;
        height: 100%;
    }

    .panel-body div b {
        color: #fff;
        padding: 0 12px;
        height: 23px;
        line-height: 23px;
        margin-top: 11px;
        border-radius: 30px;
        font-size: 14px;
        background-color: forestgreen;
    }

    .panel-body div a {
        font-size: 24px;
        color: #000;
        font-weight: 600;
    }

    .btn-lg, .btn-group-lg > .btn {
        padding: 3px 16px;
    }

    #peinsder-box {
        padding-top: 80px;
    }

    .onile-box {
        height: 100%;
    }

    body {
        overflow: hidden;
    }

    .panel-body {
        padding: 0;
        margin: 0 -14px;
    }

    .panel-body > div {
        padding: 0 24px;
    }

    .panel-body div {
        margin: 0 -14px;
        line-height: 44px;
    }

    #menu {
        overflow-x: hidden;
    }

    .bga {
        background-color: rgb(210, 245, 251);
        margin-bottom: 3px !important;

    }

    .bga:hover {
        background-color: rgb(210, 245, 251) !important;
    }

    #main {
        height: 100%;
    }

    .org {
        background-color: orange !important;
    }

    strong {
        padding: 8px;
        background-color: #ef5350;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
        margin-left: 20px;
    }

    div:hover {
        text-decoration: none !important;
    }

    strong:hover {
        opacity: .7;
    }

    .img_big {
        cursor: pointer;
        width: 200px;
        height: 200px;
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
        line-height: 175px;
        margin: 0 auto;
    }

    .img_big img {
        width: 100%;
        cursor: pointer;
    }

    .img_big embed {
        width: 100%;
        cursor: pointer !important;
    }

    .img_margin {
        display: inline-block;
        margin: 20px;
    }

    .viewer2 {
        width: 100%;
        height: 100%;
        display: none;
        overflow-y: scroll;
        padding: 50px 0;

    }

    .close {
        font-size: 40px;
        color: #ccc;
        margin: 20px;
        opacity: 1;
    }

    .close:hover {
        color: #fff;
    }
</style>
<!--[if lt IE 9]>
<script type="text/javascript" src="javascripts/html5.js"></script>
<script type="text/javascript" src="javascripts/respond.js"></script>
<![endif]-->
<body onselectstart="return false">
<!--记载过程中的loading-->
<div class="text-center">
<span class='text-center shuju-tishi shuju-tishi1' style='color:white;display: none;'>
</span>
    <span class='text-center shuju-tishi shuju-tishi2' style='background-color:red;color:white;display: none;'>
</span>
</div>

<!--导航条-->
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <!--汉堡菜单-->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                    data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="stu_model_read.html" class="selects_top" title='模型浏览'>模型浏览</a></li>
                <li><a href="oeinsder.html" title='考核培训'>考核培训</a></li>
                <li><a href="stu_xiu.html" title='检修规划'>检修规划</a></li>
                <li><a href="stu_usname.html" title='你好' class="usname_local" onload="loginas()">你好</a></li>
                <li><a href="stu_student.html" title='通知'><i class="fa fa-bell"></i></a></li>
                <li><a href="login.html" title='注销'><i class="fa fa-sign-out" style='margin-right: 7px;'></i>注销</a></li>
            </ul>
        </div>
    </div>
</nav>
<!--底部栏-->
<div class="row" id="peinsder-box">
    <!--显示课程设备学习图解-->
    <div class="container-fluid onile-box">
        <div class="col-sm-3" id="menu">
            <div class="container-fluid heard_top">
                <i class="fa fa-joomla"></i>模型目录
            </div>
            <!--<ul id="answer-sheet-num" class="answer-sheet-box">-->
            <!--&lt;!&ndash;<li role="presentation" class="active">&ndash;&gt;-->
            <!--&lt;!&ndash;<a href="#home" aria-controls="home" role="tab"&ndash;&gt;-->
            <!--&lt;!&ndash;data-toggle="tab" class="clearfix">Home <span class="pull-right">展开</span></a>&ndash;&gt;-->
            <!--&lt;!&ndash;</li>&ndash;&gt;-->
            <!--<li role="presentation" class="active">-->
            <!--<a href="#home" class="clearfix" aria-controls="home" role="tab"-->
            <!--data-toggle="tab">Home <span class="pull-right">展开</span></a>-->
            <!---->
            <!--</li>-->
            <!--&lt;!&ndash;展示题目区域&ndash;&gt;-->

            <!--</ul>-->

            <div class="panel-body panel-group" id="add_page">

            </div>

        </div>
        <div class="col-sm-9">
            <div class="container-fluid heard_top">
                <i class="fa fa-medium"></i> 模型浏览
            </div>
            <div class="tab-content" id="main">
                <div class="panel-body" style="background-color:white;">
                    <div id="tip1">目前不支持您所使用的浏览器，请使用IE浏览器进行课程学习。</div>
                    <div id="tip2">系统检测到您还未安装浏览模型所需的组件。<br/>32位操作系统请 <a href="/UploadFiles/Software/Composer_X86.exe">点此下载</a>
                        32位程序并安装。<br/>64位操作系统请下载 <a href="/UploadFiles/Software/Composer_X64.msi">点此下载</a>64位程序并安装。
                    </div>
                    <div id="wrapper">
                        <div id="showModul">
                            <div id="mainContainer">
                                <object id="viewer" class="viewer viewer1" height="800" width="800"
                                        classid="CLSID:410B702D-FCFC-46B7-A954-E876C84AE4C0">
                                    <!--value内填写.smgXml后缀文件存放路径，注意图片等文件要放在与smgXml同目录下-->
                                    <param name="_StockProps" value="0">
                                    <param name="RenderGroundShadow" value="0">
                                    <param name="RenderMode" value="1">
                                    <param name="CameraPlayMode" value="1">
                                    <param name="AntiAliasingOnIdle" value="0">
                                    <param name="GroundGrid" value="0">
                                    <param name="AutoPlay" value="0">
                                    <param name="FileName" value="/UploadFiles/Moduls/201708161528331345.smg">
                                </object>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="viewer2" id="viewer2">

            </div>
        </div>
    </div>
</div>

<!--模型资源浏览图-->
<div class="modal fade text-center" id="error-modal" tabindex="-1" role="dialog"
     aria-labelledby="modal-error-label">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">×</span></button>
    <img src="" class="modelImg" alt="center-block" style="margin: 6% 0;">
</div>

<!--培训提示信息-->
<div class="modal fade text-center" id="error-modal1" tabindex="-1" role="dialog"
     aria-labelledby="modal-error-label">
    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">×</span></button>
    <div class="acesss" id="acesss">

    </div>

</div>

<input type="hidden" id="uzid" value="">
<!--向上按钮-->
<a href="#" class="scroll-to-top"><i class="fa fa-angle-double-up"></i></a>
</body>
<script src="javascripts/jquery.1.10.2.js"></script>
<script src="stylesheets/css/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src='javascripts/template.js'></script>
<script src='javascripts/stu_ready.js'></script>
<script src="javascripts/peinsder.js"></script>
<script src='javascripts/course.js'></script>
<script id="but" type="text/html">
    {{each shiti as value index}}
    <div class="panel panel-heading btn-link btn-lg clearfix bga">
        <a class="pull-left btn_id " data-parent="#add_page" data-codeid="{{value.id}}" type="button"
           data-toggle="collapse" href="#menu{{value.id}}">{{value.name}}</a>
        <b class="pull-right btn_id " data-parent="#add_page" data-codeid="{{value.id}}" role="button"
           type="button" data-toggle="collapse"
           href="#menu{{value.id}}" style={{judeg(value.son)}}>展开</b>
    </div>
    <div id="menu{{value.id}}" class="collapse panel-collapse">

    </div>
    {{/each}}
</script>
<script id="buts" type="text/html">
    {{each shiti as value index}}
    <div class=" btn-link btn-lg clearfix model_clis " data-son="{{value.son}}">
        <a class="pull-left  btn_ids " data-parent="#add_page1" data-son="{{value.son}}" role="button"
           type="button" data-toggle="collapse"
           data-target="#menus{{value.id}}"
           data-codeid="{{value.id}}">{{value.name}}</a>
        <b class="pull-right btn_ids" data-son="{{value.son}}" role="button" type="button" data-toggle="collapse"
           data-target="#menus{{value.id}}"
           data-codeid="{{value.id}}" style={{judeg(value.son)}}>展开</b>
        <b class="pull-right org" style={{jude(value.son)}} onclick="window.location.href='{{value.download}}'">下载</b>
    </div>
    {{resources(value.son,value.imabges,value.name,value.id)}}
    <div id="menus{{value.id}}" class="collapse clearfix" style="margin: 0;">

    </div>
    {{/each}}
</script>
<script id="butss" type="text/html">
    {{each shiti as value index}}
    <div class=" bga clearfix btn-link btn-lg model_clis" data-son="{{value.son}}">
        <a class="pull-left">{{value.name}}</a>
        <b class="pull-right org" onclick="window.location.href='{{value.download}}'">下载</b>
    </div>
    {{resources(value.son,value.imabges,value.name,value.id)}}

    {{/each}}
</script>
<script id="viewer2s" type="text/html">
    {{each shiti as value index}}
    {{each value.imabges as v i}}
    <div class="img_margin">
        <div class="text-center img_big pull-left" data-file="{{v}}">
            {{templ(v)}}
        </div>
    </div>
    {{/each}}
    {{/each}}
</script>
<script type="text/javascript">
    var modelz = new models();
    //    /model/read
    modelz.ajaxGet("/model/read", function (data) {
        //获取新的数组
        var parents = [];
        $(data).each(function (i, v) {
            if (v.parentId === 0) {
                parents.push(v);
            }
        });
        var datas = {
            "shiti": parents
        }
        template.config("escape", false);

        template.helper("judeg", function (son) {
            if (son === 0) {
                return "display:none;";
            } else {
                return "display:block;";

            }
        })
        template.helper("templ", function (son) {
            var imgSrc1 = son.substr(son.lastIndexOf(".") + 1).toUpperCase();

            if (imgSrc1 !== "SWF") {
                return "<img src='" +
                    son + "' alt=''>";
            } else {
                return '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="180" height="180">'
                    + '<param name="movie" value="' + son +
                    '" />'
                    + '<param name="quality" value="high" />'
                    + '<param name="wmode" value="transparent" />'
                    + '<embed src="' +
                    son + '" onfocus="img.apply(this)" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" data-file="' +
                    son + '" width="180" height="180" wmode="transparent"></embed>'
                    + '</object>';
            }
        })
        template.helper("jude", function (son) {
            if (son !== 0) {
                return "display:none;";
            } else {
            }
            return "display:block;";
        })


        template.helper("resources", function (son, htm, ziyuan, cid) {
            if (son === 0) {
                var htms = '<div data-cid="' + cid +
                    '" class=" btn-link btn-lg clearfix resource" data-length="' +
                    htm.length + '"><a class="pull-left">' + ziyuan + "资源" +
                    '</a><strong class="bgc_num">' +
                    htm.length +
                    '</strong>' +
                    '</div>';
                return htms;
            } else {
                return "";
            }
        })
        var htm = template("but", datas);
        document.getElementById("add_page").innerHTML = htm;
        var ace = true;
        var aces = true;

        //点击资源管理
        $(document).on('click', ".resource", function () {

            var cid = $(this).attr("data-cid");
            var length = $(this).attr("data-length");
            if (length === "0") {
                $("#viewer2").html("<h4 class='text-center'>请联系管理员,添加相应的模型资源哦</h4>");
                $("#main").hide();
                $(".viewer2").show();
                return false
            }
            var newCid = [];
            $(data).each(function (i, v) {
                if (v.id === +cid) {
                    newCid.push(v);
                }
            });
            var datasets = {
                "shiti": newCid
            }
            var htm = template("viewer2s", datasets);
            document.getElementById("viewer2").innerHTML = htm;
            $("#main").hide();
            $(".viewer2").show();

            $(".img_big").click(function () {
                var imgSrc = $(this).children("img").attr("src");
//                var imgSrc1 = imgSrc.substr(imgSrc.lastIndexOf(".") + 1).toUpperCase();
                if (imgSrc === undefined) {

                } else {
                    $(".modelImg").attr("src", imgSrc);
                    $("#error-modal").modal();
                }

            })

        })
        //点击模型图形处理//问题,下方的false原因,阻止了点击事件
        $(document).on('click', ".model_clis", function () {

            var cid = $(this).attr("data-son");
            if (+cid === 0) {
                $("#main").show();
                $(".viewer2").hide();
            } else {

            }
        })


        //第一层数据展开格式
        $(".btn_id").click(function () {
            if (ace) {
                if ($(this).parent().children("b.btn_id").text() === "展开") {
                    $(this).parent().children("b.btn_id").text("折叠");
                } else {
                    $(this).parent().children("b.btn_id").text("展开");
                }
                ace = false;
            } else {
                return false
            }
            setTimeout(function () {
                ace = true;
            }, 400)

            var yid = $(this).attr("data-codeid");
            var newId = [];
            $(data).each(function (i, v) {
                if (v.parentId === +yid) {
                    newId.push(v);
                }
            });
            var datas = {
                "shiti": newId
            }
            if (newId.length === 0) {
                $(this).parent().children("b.btn_id").hide();
                return false
            }
            //避免重复添加数据
            if ($("#uzid").val() === yid) {

            } else {
                var htm = template("buts", datas);
                var names = "menu" + yid;
                document.getElementById(names).innerHTML = htm;

                $("#uzid").val(yid);
//                第二层数据格式
                $(".btn_ids").click(function () {
                    if ($(this).attr("data-son") === "0") {
                    } else {
                        if (aces) {
                            if ($(this).parent().children("b.btn_ids").text() === "展开") {
                                $(this).parent().children("b.btn_ids").text("折叠")
                            } else {
                                $(this).parent().children("b.btn_ids").text("展开")
                            }
                            aces = false;
                        } else {
                            return false
                        }
                        setTimeout(function () {
                            aces = true;
                        }, 400);
                        var yid = $(this).attr("data-codeid");
                        var newId = [];
                        $(data).each(function (i, v) {
                            if (v.parentId === +yid) {
                                newId.push(v);
                            }
                        });
                        if (newId.length === 0) {
                            $(this).parent().children("b.btn_ids").hide();
                            return false
                        }
                        var datas = {
                            "shiti": newId
                        }
                        var htmff = template("butss", datas);
                        var names = "menus" + yid;
                        document.getElementById(names).innerHTML = htmff;
                        $(document.getElementById(names)).collapse('toggle');

                    }

                })
            }
        })
    })
    function img() {
        var imgSrc = $(this).attr("data-file");
        var ace = '<embed src="' + imgSrc +
            '" class="modelImg1" alt="center-block" style="margin: 6% 0;"  quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash">';
        document.getElementById("acesss").innerHTML = ace;
        $("#error-modal1").modal();
    }
    var hei = $(window).height();
    $("#peinsder-box").height(hei);

    var currentModulId = 'e0dced9a-1b33-42bf-80fa-e4a6b939a6a0';

    var minWidth = 600;
    var minHeight = 500;
    var viewHeight = $(window).height() - 120;
    if (viewHeight < minHeight) {
        viewHeight = minHeight;
    }
    $(".viewer").height(viewHeight);
    $("#main").height(viewHeight + 50);
    var viewWidth = $(window).width() - $("#menu").width() - 15;
    $(".viewer").width((minWidth < viewWidth) ? viewWidth : minWidth);

    var viewWidth = $(window).width() - $("#menu").width();

    $(window).resize(function () {
        var viewHeight = $(window).height() - 120;
        if (viewHeight < minHeight) {
            viewHeight = minHeight;
        }
        $(".viewer").height(viewHeight);
        $("#main").height(viewHeight + 50);
        var viewWidth = $(window).width() - $("#menu").width() - 15;
        $(".viewer").width((minWidth < viewWidth) ? viewWidth : minWidth);

    });


    function isIE() { //ie?
        if (!!window.ActiveXObject || "ActiveXObject" in window)
            return true;
        else
            return false;
    }

    //检测控件是否存在
    function checkControlExist() {
        try {
            var comActiveX = new ActiveXObject("DS.3DVIAPlayerActiveXCtrl");
        }
        catch (e) {
            return false;
        }
        return true;
    }

    if (!isIE()) {
        $("#tip1").show();
        $("#tip2").hide();
        $("#wrapper").hide();
    } else {
        //检测插件是否运行加载
        if (!checkControlExist()) {
            $("#tip1").hide();
            $("#tip2").show();
            //有提示用记安装控件
            $("#wrapper").hide();
        }
        else {
            $("#tip1").hide();
            $("#tip2").hide();
            //有提示用记安装控件
            $("#wrapper").show();
        }
    }

    function collapseAccordionSub(subId, id) {
        var subItem = $("#" + id);
        var target = $("#" + subId)[0];
        if (target.innerText == "折叠") {
            $("div[tag='" + id + "'").collapse('hide');
            target.innerText = "展开";
        } else {
            target.innerText = "折叠";
            $("div[tag='" + id + "'").collapse('show');
        }
    }

    function collapseAccordion(target, id) {
        var subItem = $("#" + id);
        if (target.innerText == "折叠") {
            $("div[tag='" + id + "'").collapse('hide');
            target.innerText = "展开";
        } else {
            target.innerText = "折叠";
            $("div[tag='" + id + "'").collapse('show');
        }
    }

    function showModul(url) {
        location.href = url;
        return false;
    }

    function showItem() {
        var data = new Array();
        var content = ["40377f79-36b0-4c22-b8b2-fb5d6a5b4b05_", "32013314-f95d-4523-a9ac-dfa0ddfffdf3_"];
        if (content != 0) {
            for (var i = 0; i < content.length; i++) {
                data.push(content[i]);
            }
        }
        for (var i = 0; i < data.length; i++) {
            $("#" + data[i]).click();
        }

    }

    showItem();

    function downloadModul(id) {
        window.open("/TDVIA/GetModulFile/" + id, "_blank");
    }
</script>
</html>