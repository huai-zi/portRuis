<!doctype html>
<html lang="en" class="fixed" style='overflow: hidden'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>三门核电有限公司三门数字化仿真检修平台</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/css/bootstrap-3.3.4.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/animate.css/animate.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/toastr/toastr.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/data-table/media/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/css/subject.css">
    <style>
        .modal_span {
            display: none;
        }

        .panel {
            display: none;
        }

        .erroe-span1, .erroe-span2 {
            display: none;
        }

        .sr-only {
            clip: inherit !important;
            width: auto;
            height: auto;
        }

        .progress1 {
            display: none;
        }

        table td:first-child, table th:first-child {
            display: block !important;
        }
    </style>
</head>
<!--[if lt IE 8]>
<script type="text/javascript" src="javascripts/html5.js"></script>
<script type="text/javascript" src="javascripts/respond.js"></script>
<![endif]-->

<body>
<!--点击显示大的图片-->
<div class="big_da">
    <i class="fa  fa-close click_close" aria-hidden="true" title="关闭"></i>
    <img style="width: 50%;"
         src="" alt="">
</div>
<!--记载过程中的loading-->
<div class="text-center">
<span class='text-center shuju-tishi shuju-tishi1' style='color:white;display: none;'>
</span>
    <span class='text-center shuju-tishi shuju-tishi2' style='background-color:red;color:white;display: none;'>
</span>
</div>
<!-- 整体页面 -->
<div class="wrap">
    <!--顶部栏-->
    <div class="page-header">
        <div class="leftside-header">
            <div id="menu-toggle" class="visible-xs toggle-left-sidebar" data-toggle-class="left-sidebar-open"
                 data-target="html">
                <i class="fa fa-bars" aria-label="Toggle sidebar"></i>
            </div>
        </div>
        <div class="rightside-header">
            <div class="header-middle"></div>
            <!-- 红点信息 -->
            <div class="header-section">
                <span>你好,管理员!</span>
            </div>
            <div class="header-separator"></div>
            <div class="header-section" style="margin-right: 50px;">
                <a href="login.html" style='display: inline-block;transform:translatey(1px);'><i
                        class="fa fa-sign-out log-out"
                        aria-hidden="true"></i>注销</a>
            </div>
        </div>
    </div>
    <div class="page-body">
        <!--左侧栏-->
        <div class="left-sidebar">
            <div id="left-nav" class="nano">
                <div class="nano-content" style="right: 0 !important;">
                    <nav>
                        <ul class="nav" id="main-nav">
                            <li>
                                <a href='section.html'>
                                    <i class="fa fa-university" aria-hidden="true"></i>部门管理
                                </a>
                            </li>
                            <li  class="">
                                <a href='facility.html'>
                                    <i class="fa fa-diamond" aria-hidden="true"></i>设备管理
                                </a>
                            </li>
                            <li class="">
                                <a href='course.html'>
                                    <i class="fa fa-book" aria-hidden="true"></i>课程管理
                                </a>
                            </li>
                            <li class="">
                                <a href='model.html'>
                                    <i class="fa fa-pie-chart" aria-hidden="true"></i>模型管理
                                </a>
                            </li>
                            <li class="">
                                <a href='project.html'>
                                    <i class="fa fa-wrench" aria-hidden="true"></i>检修规划管理
                                </a>
                            </li>
                            <li class=" has-child-item close-item">
                                <a >
                                    <i class='fa fa-bar-chart' aria-hidden="true"></i>
                                    <span>考试管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li><a href='question_bang.html'>题库管理</a></li>
                                    <li><a href='test.html'>试卷管理</a></li>
                                </ul>
                            </li>
                            <li class=" has-child-item  open-item">
                                <a>
                                    <i class='fa fa-users' aria-hidden="true"></i>
                                    <span>员工管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li class="active-item"><a href='people.html'>账号管理</a></li>
                                    <li><a href='add_people_select.html'>所属部门</a></li>
                                    <li><a href='add_people_student.html'>所属角色</a></li>
                                </ul>
                            </li>
                            <li class=""><a href='pemanage.html'> <i class="fa fa-edit" aria-hidden="true"></i>PEInside管理
                            </a></li>
                            <li class=""><a href='admin_clear.html'> <i class="fa fa-trash" aria-hidden="true"></i>清理临时文件 </a></li>
                            <li class=""><a href='download.html'> <i class="fa fa-download" aria-hidden="true"></i>软件下载
                            </a></li>
                        </ul>

                    </nav>
                </div>
            </div>
        </div>
        <!--右侧栏-->
        <div class="content ">
            <div class="content-header content-header1 margin-left-click"
                 style='height: 100%;background-color: #f3f3f4;padding: 20px;'>
                <!--主体-->

                <div class="section animated fadeInRight">
                    <div class="section-head">
                        <h2>批量添加新员工</h2>
                    </div>
                    <div class="section-body clearfix">

                        <!--主体结构-->
                        <div class="col-sm-12">
                            <form enctype=multipart/form-data name="forms">

                                <!--模态框begin-->
                                <div style="padding-top: 20px;">
                                    <a href="people.html" class="btn btn-wide  color_green">
                                        员工列表
                                    </a>

                                    <a href="people_section.html" class="btn btn-wide   color_ql "
                                       style="margin-left: 20px;">
                                        部门调整
                                    </a>
                                    <a href="people_.html" class="btn btn-wide   color_blue "
                                       style="margin-left: 20px;">
                                        角色调整
                                    </a>
                                </div>

                                <div class="clearfix" style="width: 80%;margin: 0 auto;">
                                    <div class="col-xs-3 text-right">
                                        员工表格
                                    </div>
                                    <div class="col-xs-9">

                                        <input type="file" name="modelImg" id="modelImg1"
                                               accept=".csv, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">

                                    </div>
                                    <div class="col-xs-3 text-right">
                                        上传进度
                                    </div>
                                    <div class="col-xs-9">
                                        <div class="progress progress-striped" style="margin-top: 20px;">
                                            <div class="progress-bar progress-bar-success text-center"
                                                 role="progressbar"
                                                 aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                                 style="width: 0%;" id="Progress1">
                                                <span class="sr-only1"
                                                      style='clip: inherit !important;width:  61px;height: 22px;position: inherit;'></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--制作表格-->
                                <div class="panel">
                                    <div class="panel-content">
                                        <div class="table-responsive" style='overflow-x: auto'>
                                            <h3>数据展示如下：</h3>

                                            <table id="basic-table"
                                                   class="data-table table table-striped nowrap table-hover"
                                                   cellspacing="0"
                                                   width="100%">
                                                <thead>
                                                <tr>
                                                    <th>用户名</th>
                                                    <th>姓名</th>
                                                    <th>部门</th>
                                                    <th>工号</th>
                                                    <th>Email</th>
                                                    <th>电话</th>
                                                    <th>性别</th>
                                                    <th>角色</th>
                                                </tr>
                                                </thead>
                                                <tbody class="tbodya">
                                                <!--占位符-->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix">
                                    <div class="progress progress1 progress-striped active">
                                        <div class="progress-bar progress-bar-success" role="progressbar"
                                             aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                                             style="width: 100%;">
                                            <span class="sr-only">数据解析中</span>
                                        </div>
                                    </div>

                                </div>
                            </form>
                            <div class="col-xs-12 text-center">
                                <span class="btn btn-wide  color_blue color_blue_but" style="margin-top: 20px;">
                                    确认上传
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" id="Abort" value="中断上传">
            </div>
            <a href="#" class="scroll-to-top"><i class="fa fa-angle-double-up"></i></a>
        </div>
    </div>
</div>

<!--警告信息-->
<div class="modal fade" id="error-modal2" tabindex="-1" role="dialog"
     aria-labelledby="modal-error-label"
     style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header state modal-warning">
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">×</span></button>
                <h4 class="modal-title"><i class="fa fa-warning"></i>提示
                </h4>
            </div>
            <div class="modal-body">
                <span class="erroe-span1">请选择相应的xlsx文件再进行上传</span>
                <span class="erroe-span2">请上传指定的格式--账号-姓名-处室-员工号-手机号</span>
            </div>
            <div class="modal-footer">
                <!--确认删除-->
                <button type="button" class="btn " data-dismiss="modal">
                    确定
                </button>
            </div>
        </div>
    </div>
</div>


<!--培训提示信息-->
<div class="modal fade" id="error-modal" tabindex="-1" role="dialog"
     aria-labelledby="modal-error-label"
     style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header state modal-primary">
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">×</span></button>
                <h4 class="modal-title"><i class="fa fa-warning"></i>提示
                </h4>
            </div>
            <div class="modal-body">
                <span class="error-span1">信息保存成功</span>

            </div>
            <div class="modal-footer">
                <!--确认删除-->
                <button type="button" class="btn " data-dismiss="modal">
                    关闭
                </button>
            </div>
        </div>
    </div>
</div>

<script src="javascripts/jquery.1.10.2.js"></script>
<script src='javascripts/xlsx.core.min.js'></script>
<script src="stylesheets/css/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="stylesheets/css/vendor/nano-scroller/nano-scroller.js"></script>
<script src="javascripts/template-script.min.js"></script>
<script src="javascripts/template-init.min.js"></script>
<script src="stylesheets/css/vendor/media/js/jquery.dataTables.min.js"></script>
<script src="stylesheets/css/vendor/media/js/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src='javascripts/course.js'></script>
<script type="text/javascript" src='javascripts/sea.js'></script>
<script type="text/javascript">
    seajs.use('./javascripts/common.js', function (main) {
        var modelz = new models();
        var ace = new main.comm();

        ace.filesUpload("modelImg1", "Progress1", ".sr-only1", 1);

        $("#modelImg1").change(function (e) {
            if ($(this).val() === "" || $(this).val() === undefined) {
                return false
            }
            $(".progress1").show();
            ace.changeFile(e, function (datas) {
                //判断传错情况
                if (datas[0]['"账号"'] === undefined) {
                    $(".erroe-span2").show();
                    $(".erroe-span1").hide();
                    $("#error-modal2").modal();
                    $("#Abort").click();
                    //现将进度条停止
                    $("#modelImg1").get(0).files[0] = "";
                    $("#modelImg1").val('');
                    $(".sr-only1").html("");
                    $(".sr-only1").attr('title', "");
                    $("#Progress1")[0].style = "width:0 !important";
                    $("#Progress1").attr('title', "");
                    $(".panel").hide();
                    $(".progress1").hide();
                    return false
                }

                $(".panel").show();
                var options = [
                    {
                        "data": "账号",
                        "render": function (data, type, full) {
                            var fll = full['"账号"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "姓名",
                        "render": function (data, type, full) {
                            var fll = full['"姓名"'];
                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "处室",
                        "render": function (data, type, full) {
                            var fll = full['"处室"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "员工号",
                        "render": function (data, type, full) {
                            var fll = full['"员工号"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "Email",
                        "render": function (data, type, full) {
                            var fll = full['"Email"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "手机",
                        "render": function (data, type, full) {
                            var fll = full['"手机"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "性别",
                        "render": function (data, type, full) {
                            var fll = full['"性别"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    },
                    {
                        "data": "角色",
                        "render": function (data, type, full) {
                            var fll = full['"角色"'];

                            if (fll === "" || fll === undefined) {
                                return "暂无"
                            } else {
                                return fll
                            }
                        }
                    }
                ];

                modelz.datatables(datas, options, [2, 3, 4, 5, 6, 7], function (data) {
                    $(".panel").show();
                });

                window.datas = datas;

            })
        });


        $(".color_blue_but").click(function () {
            if ($("#modelImg1").val() === "" || window.datas === undefined) {
                $(".erroe-span1").show();
                $(".erroe-span2").hide();
                $("#error-modal2").modal();
                return false
            } else {
                //上传数据并数据保存成功
                ace.ajaxform("/createByExcel", window.datas, function (data) {
                    if (data.type === 0) {
                        $("#error-modal").modal();
                        window.location.href = "people.html";
                    }
                });
            }

        })

    });


</script>
</body>
</html>