<!doctype html>
<html lang="en" class="fixed" style='overflow: hidden'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>三门核电有限公司三门数字化仿真检修平台</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/css/bootstrap-3.3.4.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/animate.css/animate.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/toastr/toastr.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/data-table/media/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/css/subject.css">
    <link rel="stylesheet" href="stylesheets/css/course.css">
</head>
<!--[if lt IE 9]>
<script type="text/javascript" src="javascripts/html5.js"></script>
<script type="text/javascript" src="javascripts/respond.js"></script>
<![endif]-->
<style>
    .progress {
        display: none;
    }
</style>
<body onselectstart="return false">
<!--点击显示大的图片-->
<div class="big_da">
    <i class="fa  fa-close click_close" aria-hidden="true"></i>
    <img style="width: 50%;"
         src="http://pic.qiantucdn.com/58pic/16/40/37/22X58PICtFy.jpg!/fw/300/clip/0x400a0a0/format/webp" alt="">
</div>
<!--记载过程中的loading-->
<div class="text-center">
<span class='text-center shuju-tishi shuju-tishi1' style='color:white;display: none;'>
</span>
    <span class='text-center shuju-tishi shuju-tishi2' style='background-color:red;color:white;display: none;'>
</span>
</div>
<!--模态框-->
<div class="modal fade " id="error-modal55" tabindex="-1" role="dialog" aria-labelledby="modal-error-label"
     style="display: none; padding-right: 17px;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header state modal-danger">
                <h4 class="modal-title"><i class="fa fa-warning"></i>删除信息</h4>
            </div>
            <div class="modal-body">
                请您考虑清楚!确认删除此条用户信息!删除不可恢复!!!
            </div>
            <div class="modal-footer">
                <!--确认删除-->
                <button type="button" class="btn btn-danger" id="remove55" data-dismiss="modal">确认删除</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" id="remove555">取消删除</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="sm-modal" tabindex="-1" role="dialog"
     aria-labelledby="modal-default-label" style="display: none; padding-right: 16px;">
    <div class="modal-dialog modal-md" role="document">
        <div class="modal-content">
            <div class="modal-header state modal-primary">
                <button type="button" class="close" data-dismiss="   modal" aria-label="Close"><span
                        aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="modal-large-label">添加岗位</h4>
            </div>
            <div class="modal-body modal-timu">
                <div class="form-group">
                    <!--岗位-->
                    <label class="control-label">请选择相应的部门及专业:</label>
                    <div id="area" class="area"></div>
                </div>
                <div class="form-group">
                    <label for="station1" class="control-label">岗位:</label>
                    <input type="text" class="form-control" id="station1">
                </div>
                <div class="form-group">
                    <!--身份-->
                    <label class="control-label">岗位备注:</label>
                    <textarea style='max-width: 568px;' class="form-control"
                              id="station2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                        <span class="password-yanzheng pull-left warm-xinxi2"
                              style="display: none;line-height: 35px;"><i class="fa fa-info-circle fa-lg"></i>&nbsp;&nbsp;请将空白部分补充完整</span>
                <button type="button" id="station" class="btn btn-primary" data-dismiss="modal">确认添加
                </button>
                <button type="button" class="btn  btn-danger" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<!-- 整体页面 -->
<div class="wrap">
    <!--顶部栏-->
    <div class="page-header">
        <div class="leftside-header">
            <div id="menu-toggle" class="visible-xs toggle-left-sidebar" data-toggle-class="left-sidebar-open"
                 data-target="html">
                <i class="fa fa-bars" aria-label="Toggle sidebar"></i>
            </div>
        </div>
        <div class="rightside-header">
            <div class="header-middle"></div>
            <!-- 红点信息 -->
            <div class="header-section">
                <span>你好,管理员!</span>
            </div>
            <div class="header-separator"></div>
            <div class="header-section" style="margin-right: 50px;">
                <a href="login.html" style='display: inline-block;transform:translatey(1px);'><i
                        class="fa fa-sign-out log-out" aria-hidden="true"></i>注销</a>
            </div>
        </div>
    </div>
    <div class="page-body">
        <!--左侧栏-->
        <div class="left-sidebar">
            <div id="left-nav" class="nano">
                <div class="nano-content" style="right: 0 !important;">
                    <nav>
                        <ul class="nav" id="main-nav">
                            <li>
                                <a href='section.html'>
                                    <i class="fa fa-university" aria-hidden="true"></i>部门管理
                                </a>
                            </li>
                            <li  class="active-item">
                                <a href='facility.html'>
                                    <i class="fa fa-diamond" aria-hidden="true"></i>设备管理
                                </a>
                            </li>
                            <li class="">
                                <a href='course.html'>
                                    <i class="fa fa-book" aria-hidden="true"></i>课程管理
                                </a>
                            </li>
                            <li class="">
                                <a href='model.html'>
                                    <i class="fa fa-pie-chart" aria-hidden="true"></i>模型管理
                                </a>
                            </li>
                            <li class="">
                                <a href='project.html'>
                                    <i class="fa fa-wrench" aria-hidden="true"></i>检修规划管理
                                </a>
                            </li>
                            <li class=" has-child-item close-item">
                                <a>
                                    <i class='fa fa-bar-chart' aria-hidden="true"></i>
                                    <span>考试管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li><a href='question_bang.html'>题库管理</a></li>
                                    <li><a href='test.html'>试卷管理</a></li>
                                </ul>
                            </li>
                            <li class=" has-child-item close-item">
                                <a>
                                    <i class='fa fa-users' aria-hidden="true"></i>
                                    <span>员工管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li><a href='people.html'>账号管理</a></li>
                                    <li><a href='add_people_select.html'>所属部门</a></li>
                                    <li><a href='add_people_student.html'>所属角色</a></li>
                                </ul>
                            </li>
                            <li class=""><a href='pemanage.html'> <i class="fa fa-edit" aria-hidden="true"></i>PEInside管理
                            </a></li>
                            <li class=""><a href='admin_clear.html'> <i class="fa fa-trash" aria-hidden="true"></i>清理临时文件 </a></li>
                            <li class=""><a href='download.html'> <i class="fa fa-download" aria-hidden="true"></i>软件下载
                            </a></li>
                        </ul>

                    </nav>
                </div>
            </div>
        </div>
        <!--右侧栏-->
        <div class="content ">
            <div class="content-header content-header1 margin-left-click"
                 style='height: 100%;background-color: #f3f3f4;padding: 20px;'>
                <!--主体-->

                <div class="section animated fadeInRight">
                    <div class="section-head">
                        <h2>设备管理</h2>
                    </div>
                    <div class="section-body clearfix">
                        <!--主体结构-->
                        <div class="col-sm-12">
                            <!--模态框begin-->
                            <a href="add_facility.html" class="btn btn-wide btn-primary addTo">
                                添加设备信息
                            </a>
                            <!--制作表格-->
                            <div class="panel">
                                <div class="panel-content">
                                    <div class="table-responsive">
                                        <table id="basic-table"
                                               class="data-table table table-striped nowrap table-hover" cellspacing="0"
                                               width="100%">
                                            <thead>
                                            <tr>
                                                <th>标识</th>
                                                <th>名称</th>
                                                <th>图像</th>
                                                <th>备注</th>
                                                <th>操作</th>
                                            </tr>
                                            </thead>
                                            <tbody class="tbodya">
                                            <!--占位符-->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <a href="#" class="scroll-to-top"><i class="fa fa-angle-double-up"></i></a>
        </div>
    </div>
</div>

<!--添加设备-->
<div class="modal fade" id="lg-modal1" tabindex="-1" role="dialog"
     aria-labelledby="modal-large-label">
    <div class="modal-dialog modal-md" role="document">
        <form method=post name="model_xx" id="form01" enctype=multipart/form-data>
            <div class="modal-content">
                <div class="modal-header state modal-primary">

                    <h4 class="modal-title"><i class="fa fa-puzzle-piece"></i>删除设备</h4>

                </div>

                <div class="modal-body clearfix">
                    <h3>确定要删除这个设备及所属课程吗？</h3>
                    <div class="clearfix">
                        <div class="text-right col-xs-3">
                            设备名称
                        </div>
                        <div class=" col-xs-9">
                            <span id="course_name"></span>
                        </div>
                    </div>
                    <div class="clearfix">
                        <div class="text-right col-xs-3">
                            设备图像
                        </div>
                        <div class=" col-xs-9">
                            <img src="" alt="暂无图像信息" id="course_img">
                        </div>
                    </div>
                    <div class="clearfix">
                        <div class="text-right col-xs-3">
                            描述
                        </div>
                        <div class=" col-xs-9">
                            <span id="course_xs"></span>
                        </div>
                    </div>
                </div>
                <div class="progress progress-striped active">
                    <div class="progress-bar progress-bar-success" role="progressbar"
                         aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"
                         style="width: 100%;">
                    </div>
                </div>
                <div class="modal-footer text-center">

                    <button type="button" class="btn  btn-default color_green itm_qx" data-dismiss="modal"> 确定</button>
                    <button type="button" class="btn  btn-default   " data-dismiss="modal"> 取消</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script src="javascripts/jquery.1.10.2.js"></script>
<script src="stylesheets/css/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="stylesheets/css/vendor/nano-scroller/nano-scroller.js"></script>
<script src="javascripts/template-script.min.js"></script>
<script src="javascripts/template-init.min.js"></script>
<script src="stylesheets/css/vendor/media/js/jquery.dataTables.min.js"></script>
<script src="stylesheets/css/vendor/media/js/dataTables.bootstrap.min.js"></script>
<script src='javascripts/course.js'></script>
<script type="text/javascript" src='javascripts/sea.js'></script>
<script type="text/javascript">
    seajs.use('./javascripts/common.js', function (main) {
        var ace = new main.comm();
        var modelz = new models();
        window.textId = '';

        var options = [
            {"data": "id"},
            {"data": "name"},
            {
                "data": "image",
                "render": function (data, type, full, set) {
                    var a = "";
                    a = '<img src="' + full.image + '" alt="">';
                    return a
                }
            },
            {
                "data": "note",
                "render": function (data, type, full, set) {
                    if (full.note === null || full.note === undefined) {
                        return ""
                    } else {
                        return full.note
                    }
                }
            },
            {
                "data": "note",
                "render": function (data, type, full, set) {
                    /*返回的数据拼接*/
                    return "<button type='button' class='btn1 course_bj notazirez'>编辑</button><button type='button' class='btn1 course_remove removeShuju' data-toggle='modal' data-target='#lg-modal1'>删除</button>"
                }
            }
        ];

        var fac = [];
        ace.ajaxGet("/course/read", function (data) {
            $(data).each(function (i, v) {
                //为空的值放到设备管理
                if (v.parentId === 0) {
                    fac.push(v);
                }
            })
            modelz.datatables(fac, options, [2, 3, 4], function (data) {
                var aa1 = '';
                //编辑设备
                $('.notazirez').click(function () {
                    aa1 = $(this).parent().parent().children().eq(0).text();
                    $(data.aoData).each(function (i, v) {
                        if (+aa1 === v._aData.id) {
                            console.log(v._aData);
                            localStorage.setItem("facility", JSON.stringify(v._aData));
                        }
                    })
                    window.location.href = "amend_facility.html";
                })

                $('.removeShuju').on("click", function () {
                    window.textId = $(this).parent().parent().children().eq(0).text();
                    $(data.aoData).each(function (i, v) {
                        if (+window.textId === v._aData.id) {
                            $("#course_name").text(v._aData.name);
                            $("#course_img").attr("src", v._aData.image);
                            $("#course_xs").text(v._aData.note);
                        }
                    })
                    window.tre= $(this).parent().parent()[0];

                })
            })

        })

        //确认删除
        $('.itm_qx').click(function () {
            var dataset = {
                "id": window.textId
            };
            $(".progress").show();

            modelz.ajaxform("/course/delete", dataset, function (data) {
                if(data.type === 0){
                    $(".progress").hide();
                    var table = $('.data-table').DataTable();
                    table.row(window.tre).remove().draw();
                }

            })
            //取到id,与数据进行对比,加载模态框

        })
    });

    $(function () {

        //删除传送数据

        $('.big_da').click(function () {
            return false
        })
        $('.big_da > img').click(function () {
            return false
        })
        $('.click_close').on('click', function () {
            $(this).parent().css("display", "none");
        })

        //编辑模型

    })
</script>
</body>
</html>