<!doctype html>
<html lang="en" class="fixed" style='overflow: hidden'>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>三门核电有限公司三门数字化仿真检修平台</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/css/bootstrap-3.3.4.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/animate.css/animate.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/toastr/toastr.min.css">
    <link rel="stylesheet" href="stylesheets/css/vendor/magnific-popup/magnific-popup.css">

    <link rel="stylesheet" href="stylesheets/css/vendor/data-table/media/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="stylesheets/css/subject.css">
    <link rel="stylesheet" href="stylesheets/css/question-bank.css">
</head>
<!--[if lt IE 8]>
<script type="text/javascript" src="javascripts/html5.js"></script>
<script type="text/javascript" src="javascripts/respond.js"></script>
<![endif]-->
<style>
    #basic-table {
        width: 80%;
        margin: 0 auto;
        margin-bottom: 30px;
        display: none;
    }

    #basic-table_wrapper {
        padding-bottom: 40px;
    }
</style>
<body onselectstart="return false">

<!--记载过程中的loading-->
<div class="text-center">
<span class='text-center shuju-tishi shuju-tishi1' style='color:white;display: none;'>
</span>
    <span class='text-center shuju-tishi shuju-tishi2' style='background-color:red;color:white;display: none;'>
</span>
</div>
<!-- 整体页面 -->
<div class="wrap">
    <!--顶部栏-->
    <div class="page-header">
        <div class="leftside-header">
            <div id="menu-toggle" class="visible-xs toggle-left-sidebar" data-toggle-class="left-sidebar-open"
                 data-target="html">
                <i class="fa fa-bars" aria-label="Toggle sidebar"></i>
            </div>
        </div>
        <div class="rightside-header">
            <div class="header-middle"></div>
            <!-- 红点信息 -->
            <div class="header-section">
                <a href="">你好,吴亮!</a>
            </div>
            <div class="header-separator"></div>
            <div class="header-section" style="margin-right: 50px;">
                <a href="login.html" style='display: inline-block;transform:translatey(1px);'><i
                        class="fa fa-sign-out log-out" aria-hidden="true"></i>注销</a>
            </div>
        </div>
    </div>
    <div class="page-body">
        <!--左侧栏-->
        <div class="left-sidebar">
            <div id="left-nav" class="nano">
                <div class="nano-content" style="right: 0 !important;">
                    <nav>
                        <ul class="nav" id="main-nav">
                            <li>
                                <a href='section.html'>
                                    <i class="fa fa-university" aria-hidden="true"></i>部门管理
                                </a>
                            </li>
                            <li class="">
                                <a href='facility.html'>
                                    <i class="fa fa-diamond" aria-hidden="true"></i>设备管理
                                </a>
                            </li>
                            <li class="">
                                <a href=''>
                                    <i class="fa fa-book" aria-hidden="true"></i>课程管理
                                </a>
                            </li>
                            <li class="">
                                <a href='model.html'>
                                    <i class="fa fa-pie-chart" aria-hidden="true"></i>模型管理
                                </a>
                            </li>
                            <li class="">
                                <a href=''>
                                    <i class="fa fa-wrench" aria-hidden="true"></i>检修规划管理
                                </a>
                            </li>
                            <li class=" has-child-item open-item">
                                <a>
                                    <i class='fa fa-bar-chart' aria-hidden="true"></i>
                                    <span>考试管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li class="active-item"><a href='question-bang.html'>题库管理</a></li>
                                    <li><a href='test.html'>试卷管理</a></li>
                                </ul>
                            </li>
                            <li class=" has-child-item close-item">
                                <a>
                                    <i class='fa fa-users' aria-hidden="true"></i>
                                    <span>员工管理</span>
                                </a>
                                <ul class="nav child-nav level-1">
                                    <li><a href=''>账号管理</a></li>
                                    <li><a href=''>所属部门</a></li>
                                    <li><a href=''>所属角色</a></li>
                                </ul>
                            </li>
                            <li class="">                                <a href='pemanage.html'>                                    <i class="fa fa-edit" aria-hidden="true"></i>PEInside管理                                </a>                            </li>                            <li class="">                                <a href=''>                                    <i class="fa fa-trash" aria-hidden="true"></i>清理临时文件                                </a>                            </li>                            <li class="">                                <a href='download.html'>                                    <i class="fa fa-download" aria-hidden="true"></i>软件下载                                </a>                            </li>
                        </ul>

                    </nav>
                </div>
            </div>
        </div>
        <!--右侧栏-->
        <div class="content ">
            <div class="content-header content-header1 margin-left-click"
                 style='height: 100%;background-color: #f3f3f4;padding: 20px;'>
                <!--主体-->
                <div class="container-fluid">
                    <div class="section animated fadeInRight">
                        <div class="section-head">
                            <h2>题库管理</h2>
                        </div>
                        <div class="section-body clearfix">
                            <!--主体结构-->
                            <div>
                                设备
                                <select name="" id="facility">
                                    <option value="">请选择设备</option>
                                    <option value="1">爆破阀</option>
                                </select>
                                课程
                                <select name="" id="curriculum">
                                    <option value="">请选择相应的课程</option>
                                    <option value="2">课程</option>
                                </select>
                            </div>
                            <a class="pull-right btn btn-wide btn-success" href="add_quertion_bang.html" title='添加新题目'>添加新题目</a>
                            <a class="pull-right btn btn-info" href='upload_quertion_bang.html'
                               style='margin-right: 5px' title='批量添加'>批量添加</a>
                        </div>
                        <div class="">
                            <!--表格数据-->
                            <table id="basic-table"
                                   class="data-table table table-striped nowrap table-hover" cellspacing="0"
                                   width="100%">
                                <thead>
                                <tr>
                                    <th>标识</th>
                                    <th>题型</th>
                                    <th>题干</th>
                                    <th>创建时间</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody class="tbodya">
                                <!--占位符-->
                                </tbody>
                            </table>
                        </div>
                        <div class="section-foot">
                            选择设备及课程查看题目，或点击 <a href="">这儿</a> 添加。
                            <button type="button" class="close" id="select-close"><span>×</span><span class="sr-only">Close</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--删除按钮模态框-->
<div class="modal fade" id="error-modal" tabindex="-1" role="dialog"
     aria-labelledby="modal-error-label"
     style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header state modal-danger">
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close"><span
                        aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="modal-error-label"><i class="fa fa-warning"></i>提示
                </h4>
            </div>
            <div class="modal-body">
                <span id="modal_remove"></span>题目被删除后，将不能再恢复。确定删除吗？
            </div>
            <div class="modal-footer">
                <!--确认删除-->
                <button type="button" class="btn btn-danger itm_qx" data-dismiss="modal">
                    确定
                </button>
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
            </div>
        </div>
    </div>
</div>
<script src="javascripts/jquery.1.10.2.js"></script>
<script src="stylesheets/css/vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="stylesheets/css/vendor/nano-scroller/nano-scroller.js"></script>
<script src="javascripts/template-script.min.js"></script>
<script src="javascripts/template-init.min.js"></script>
<script src="stylesheets/css/vendor/toastr/toastr.min.js"></script>
<script src="stylesheets/css/vendor/media/js/jquery.dataTables.min.js"></script>
<script src="stylesheets/css/vendor/media/js/dataTables.bootstrap.min.js"></script>
<script src="stylesheets/css/vendor/magnific-popup/jquery.magnific-popup.min.js"></script>
<script type="text/javascript" src='javascripts/course.js'></script>
<script type="text/javascript" src='javascripts/sea.js'></script>
<script type="text/javascript">
    seajs.use('./javascripts/common.js', function (main) {
        var ace = new main.comm();
        //隐藏栏目
        ace.select_but.click(function () {
            $(this).parent().slideUp();
        });

        //对数据进行
        ace.ajaxGet('tables.json', function (data) {
            ace.select_facility[0].options[0] = new Option('请选择设备', '')
            $(data).each(function (i, v) {
                ace.select_facility[0].options[i + 1] = new Option(v.name, v.id);
            })
        });

        //设备变化
        ace.select_facility.on('change', function () {
            var that = $(this);
            var val = that.val();
            if (val === '') {

            } else {
                var dataset = {
                    "id": val
                }
                ace.ajaxPost(url, dataset, function (data) {

                    ace.select_curriculum[0].options[0] = new Option('请选择相应的课程', '')
                    if (data === "") {

                    } else {
                        //增加相应课程类目
                        $(data).each(function (i, v) {
                            ace.select_curriculum[0].options[i + 1] = new Option(v.name, v.id);
                        })
                    }

                })
            }
        })
        //课程变化
        window.aa5 = "";
        ace.select_curriculum.on('change', function () {

            var that = $(this);
            var val = that.val();


            var dataset = {
                "id": val
            };
            //数据重新加载
            var options = [
                {"data": "id"},
                {"data": "name"},
                {
                    "data": "position"
                },
                {
                    "data": "remarks",
                    "render": function (data, type, full, set) {
                        return "2017-05-19 11:11"
                    }
                },
                {
                    "data": "remarks",
                    "render": function (data, type, full, set) {
                        /*返回的数据拼接*/
                        return "<button type='button' class='btn1 course_bj notazirez'>编辑</button><button type='button' class='btn1 course_remove removeShuju' data-toggle='modal' data-target='#lg-modal1'>删除</button>"
                    }
                }
            ];
            //加载表格数据
            ace.datatables('models.json', options, [2, 3, 4], function (data) {


                //点击编辑
                var aa1 = '';
                window.aa5 = '';
                $('.notazirez').click(function () {
                    aa1 = $(this).parent().parent().children().eq(0).text();
                    $(data.aoData).each(function (i, v) {
                        if (+aa1 === v._aData.id) {
                            localStorage.setItem("question", JSON.stringify(v._aData));
                        }
                    })
                    window.location.href = "amend_question_bang.html"
                });


                $(".removeShuju").click(function () {
                    window.aa5 = $(this).parent().parent().children().eq(0).text();
                    console.log(window.aa5);
                    $("#error-modal").modal();
                })

            });
            val === "" ? $("#basic-table").hide() &&
                $("#basic-table_wrapper").hide() &&
                $(".section-foot").show() :
                $("#basic-table").show() &&
                $("#basic-table_wrapper").show() &&
                $(".section-foot").hide();

            ace.ajaxPost(url, dataset, function (data) {
                //加载到页面上
                if (data === '') {

                }

            });
        });

        var mo = new models();
        console.log(mo);
        $('.itm_qx').click(function () {
            var dataset = {
                "id": window.aa5
            };
            console.log(dataset);
            mo.ajaxform(url, dataset, function () {
                mo.tables();
            })
            //取到id,与数据进行对比,加载模态框

        })
    })
</script>
</body>
</html>